<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Shortify - URL Shortener</title>
        <link rel="stylesheet" href="/css/home.css" />
    </head>

    <body>
        <h1>ðŸ”— Shortify - URL Shortener</h1>

        <% if (user) { %>
            <p style="margin-left: 2rem">Welcome, <%= user.name %> ðŸ‘‹</p>
            <% } %>
                <!-- Display newly created Short URL if 'id' is present in the query string -->
                <% if (locals.id) { %>
                    <div class="generated-url">
                        <p>
                            Your New Short URL:<br />
                            <a target="_blank" href="/url/<%= id %>">
                                <%= req.protocol + '://' + req.headers.host + '/url/' + id %>
                            </a>
                        </p>
                    </div>
                    <% } %>

                        <!-- URL Shortener Form -->
                        <div>
                            <form method="POST" action="/url">
                                <label for="url">Enter a Long URL</label>
                                <input type="text" name="url" id="url" placeholder="https://example.com/long-url-path"
                                    required />
                                <button type="submit">Generate Short Link</button>
                            </form>
                        </div>

                        <!-- Display All Short URLs -->
                        <% if (locals.urls && locals.urls.length> 0) { %>
                            <div style="margin-top: 2rem">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Short ID</th>
                                            <th>Original URL</th>
                                            <th>Clicks</th>
                                            <th>Redirect Link</th>
                                            <th>Analytics</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% urls.forEach((url, index)=> { %>
                                            <tr>
                                                <td>
                                                    <%= index + 1 %>
                                                </td>
                                                <td>
                                                    <%= url.shortId %>
                                                </td>
                                                <td>
                                                    <a href="<%= url.redirectUrl %>" target="_blank">
                                                        <%= url.redirectUrl %>
                                                    </a>
                                                </td>
                                                <td>
                                                    <%= url.visitHistory.length %>
                                                </td>
                                                <td>
                                                    <a href="/url/<%= url.shortId %>" target="_blank">
                                                        <%= req.protocol + '://' + req.headers.host + '/url/' +
                                                            url.shortId %>
                                                    </a>
                                                </td>
                                                <td>
                                                    <a href="/url/analytics/<%= url.shortId %>">View
                                                        Analytics</a>
                                                </td>
                                            </tr>
                                            <% }); %>
                                    </tbody>
                                </table>
                            </div>
                            <% } else { %>
                                <p style="margin-left: 2rem">No URLs created yet.</p>
                                <% } %>
    </body>

</html>